ETAPA BÔNUS: monitoramento

1 - Instalar o PGbadger

sudo apt update
sudo apt install pgbadger

pdbadger --version para verificar se instalou 

Configurar o Postgree para gerar os logs:

Pgbadger: é uma ferramenta que pega os logs gerados pelo Postgreesql e então gera um arquivo HTML mais bonitinho que pode ser analisado.


2 - instalar o cliente do postgresql 

postgresql-client que vai nos permitir executar o comando pgql


3 - acessar client postgree

psql -h localhost -U postgres


4 - encontrar arquivo de configuração do postgree

show config_file;

inserimos nesse arquivo conf algumas configurações para geração de logs que serão lidos pelo Pgbadger:

Inserir:

logging_collector = on

log_directory = 'log'
log_filename = 'postgresql-%Y-%m-%d.log'

log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '

log_min_duration_statement = 500

log_checkpoints = on
log_connections = on
log_disconnections = on



5 - visualizar os logs:

ls /var/log/postgresql/


6 - Executar o PGbadger com o log gerado no Postgree:

pgbadger /var/log/postgresql/<substituir nome do log aqui> -o ~/pgbadger_relatorio.html
